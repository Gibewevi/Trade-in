generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum AccessLevel {
  FREE
  PREMIUM
}

model user {
  id            Int             @id @default(autoincrement())
  email         String          @unique
  password      String
  subscriptions subscription[]  @relation("userToSubscription")
  
  @@map("users")
}

model subscription {
  id        Int       @id @default(autoincrement())
  userId    Int
  user      user      @relation("userToSubscription", fields: [userId], references: [id])
  @@map("subscriptions")
}


model chapter {
 id          Int      @id @default(autoincrement())
 chapterId   Int      @unique
 title       String
 description String
 lessons     lesson[] @relation("chapterToLesson")
 duration     Int     @default(0)

 @@map("chapters")
}

model lesson {
 id           Int         @id @default(autoincrement())
 lessonId     Int         @unique
 title        String
 slug         String      @unique
 contentUrl   String
 thumbnailUrl String
 isNew        Boolean     @default(true)
 createdAt    DateTime    @default(now())
 chapterId    Int
 chapter      chapter     @relation("chapterToLesson", fields: [chapterId], references: [chapterId])
 accessLevel AccessLevel
 isFree       Boolean     @default(false)
 duration     Int         @default(0)

 @@map("lessons")
}

model Tweet {
  id          Int      @id @default(autoincrement())
  tweetId     String   @unique // L'ID unique du tweet fourni par Twitter
  content     String   // Des informations textuelles relatives au tweet, comme des mots-clés
  publishedAt DateTime // La date de parution du tweet sur Twitter
  createdAt   DateTime @default(now()) // La date de stockage du tweet dans votre base de données

  @@map("tweets") // Spécifie le nom de la table en minuscules dans la BDD
}

model Category {
  id          Int      @id @default(autoincrement())
  name        String   @unique
  description String?
  prompt      String?  // Ajout d'un champ prompt pour stocker le modèle de prompt de génération de texte
  articles    Article[] @relation("categoryToArticle")
  
  @@map("categories")
}

model Article {
  id          Int       @id @default(autoincrement())
  title       String
  content     String
  htmlContent String
  publishedAt DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  categoryId  Int
  category    Category  @relation("categoryToArticle", fields: [categoryId], references: [id])
  
  @@map("articles")
}
